<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”™è¯¯è¯Šæ–­é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        h3 {
            margin-top: 0;
            color: #333;
        }
        .status {
            padding: 8px 12px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        button {
            padding: 10px 15px;
            margin: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .highlight {
            background-color: yellow;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>é”™è¯¯è¯Šæ–­é¡µé¢</h1>
        
        <div class="section">
            <h3>å¸¸è§é”™è¯¯åŸå› </h3>
            <div class="code-block">åŸºäºauth/configuration-not-foundé”™è¯¯ï¼Œå¯èƒ½çš„åŸå› åŒ…æ‹¬ï¼š

1. Firebaseé¡¹ç›®é…ç½®é—®é¢˜ï¼š
   - é¡¹ç›®æœªåœ¨Firebaseæ§åˆ¶å°ä¸­æ­£ç¡®è®¾ç½®
   - AuthenticationåŠŸèƒ½æœªå¯ç”¨
   - Email/Passwordç™»å½•æ–¹å¼æœªå¯ç”¨

2. SDKç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜ï¼š
   - å·²æ›´æ–°åˆ°9.22.1ç‰ˆæœ¬

3. åˆå§‹åŒ–é—®é¢˜ï¼š
   - å·²æ·»åŠ é˜²é‡å¤åˆå§‹åŒ–é€»è¾‘

4. åŸŸåæœªæˆæƒï¼š
   - localhostéœ€è¦æ·»åŠ åˆ°Firebaseæ§åˆ¶å°çš„æˆæƒåŸŸååˆ—è¡¨</div>
        </div>
        
        <div class="section">
            <h3>è¯Šæ–­å·¥å…·</h3>
            <button onclick="runFullDiagnosis()">è¿è¡Œå®Œæ•´è¯Šæ–­</button>
            <div id="diagnosis-results" class="code-block" style="display:none;"></div>
        </div>
        
        <div class="section">
            <h3>ä¿®å¤å»ºè®®</h3>
            <div class="code-block">Firebaseæ§åˆ¶å°æ“ä½œæ­¥éª¤ï¼š
1. è®¿é—® https://console.firebase.google.com
2. é€‰æ‹©é¡¹ç›® "cuihua-todolist"
3. è¿›å…¥ "Authentication" éƒ¨åˆ†
4. ç‚¹å‡» "Sign-in method" æ ‡ç­¾
5. å¯ç”¨ "Email/Password" æä¾›å•†
6. è¿›å…¥ "Settings" â†’ "Authorized domains"
7. æ·»åŠ  "localhost" åˆ°å…è®¸çš„åŸŸååˆ—è¡¨</div>
        </div>
        
        <div class="section">
            <h3>æµ‹è¯•é¡µé¢</h3>
            <button onclick="location.href='./index.html'">è¿”å›åº”ç”¨</button>
            <button onclick="location.href='./firebase_config_test.html'">é…ç½®æµ‹è¯•</button>
            <button onclick="location.href='./troubleshooting_guide.html'">æ•…éšœæ’é™¤</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script>
        async function runFullDiagnosis() {
            const resultsDiv = document.getElementById('diagnosis-results');
            resultsDiv.style.display = 'block';
            let output = "=== å®Œæ•´è¯Šæ–­ ===\n\n";

            try {
                output += "1. æ£€æŸ¥é¡µé¢ç¯å¢ƒ...\n";
                output += `   å½“å‰URL: ${window.location.href}\n`;
                output += `   åŸŸå: ${window.location.hostname}\n`;
                output += `   ç«¯å£: ${window.location.port}\n\n`;

                output += "2. æ£€æŸ¥Firebase SDKåŠ è½½...\n";
                if (typeof firebase !== 'undefined') {
                    output += `   âœ… Firebase SDKå·²åŠ è½½\n`;
                    output += `   ç‰ˆæœ¬: ${firebase.SDK_VERSION || 'æœªçŸ¥'}\n`;
                } else {
                    output += `   âŒ Firebase SDKæœªåŠ è½½\n`;
                }
                
                output += "\n3. æ£€æŸ¥å…¼å®¹åŒ…...\n";
                const hasAppCompat = typeof firebase !== 'undefined' && typeof firebase.initializeApp !== 'undefined';
                output += `   app-compat: ${hasAppCompat ? 'âœ…' : 'âŒ'}\n`;
                
                if (hasAppCompat) {
                    output += "\n4. æ£€æŸ¥é…ç½®æ–‡ä»¶åŠ è½½...\n";
                    try {
                        // æ£€æŸ¥æ˜¯å¦æœ‰firebaseé…ç½®
                        const scriptTags = Array.from(document.querySelectorAll('script'));
                        const hasConfig = scriptTags.some(script => script.src && script.src.includes('firebase-config'));
                        output += `   firebase-config.js: ${hasConfig ? 'âœ…' : 'âŒ'}\n`;
                        
                        if (!hasConfig) {
                            output += "   âš ï¸ é…ç½®æ–‡ä»¶å¯èƒ½æœªæ­£ç¡®åŠ è½½\n";
                        }
                    } catch (e) {
                        output += `   æ£€æŸ¥é…ç½®æ–‡ä»¶æ—¶å‡ºé”™: ${e.message}\n`;
                    }
                }
                
                output += "\n5. æ£€æŸ¥è®¤è¯æœåŠ¡å¯ç”¨æ€§...\n";
                try {
                    // å°è¯•åŠ¨æ€åŠ è½½è®¤è¯æ¨¡å—
                    const authScript = document.createElement('script');
                    authScript.src = 'https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js';
                    document.head.appendChild(authScript);
                    
                    // ç­‰å¾…è„šæœ¬åŠ è½½
                    await new Promise(resolve => {
                        authScript.onload = resolve;
                        setTimeout(resolve, 2000); // 2ç§’è¶…æ—¶
                    });
                    
                    if (typeof firebase.auth !== 'undefined') {
                        output += `   auth-compat: âœ… å¯ç”¨\n`;
                    } else {
                        output += `   auth-compat: âŒ ä¸å¯ç”¨\n`;
                    }
                } catch (e) {
                    output += `   åŠ¨æ€åŠ è½½authæ¨¡å—å¤±è´¥: ${e.message}\n`;
                }
                
                output += "\n6. æ£€æŸ¥ç½‘ç»œè¿æ¥...\n";
                try {
                    const response = await fetch('https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js', { method: 'HEAD' });
                    output += `   Firebase CDNè¿æ¥: ${response.ok ? 'âœ… æ­£å¸¸' : 'âŒ å¼‚å¸¸'}\n`;
                } catch (e) {
                    output += `   Firebase CDNè¿æ¥: âŒ é”™è¯¯ - ${e.message}\n`;
                }
                
                output += "\n7. è¯Šæ–­å®Œæˆ\n";
                output += "\nğŸ’¡ ä¿®å¤å»ºè®®:\n";
                output += "   - æ£€æŸ¥Firebaseæ§åˆ¶å°é…ç½®\n";
                output += "   - ç¡®ä¿å¯ç”¨äº†Email/Passwordç™»å½•\n";
                output += "   - æ·»åŠ localhoståˆ°æˆæƒåŸŸå\n";
                output += "   - æ£€æŸ¥é˜²ç«å¢™/ä»£ç†è®¾ç½®\n";

            } catch (e) {
                output += `\nâŒ è¯Šæ–­è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯: ${e.message}\n${e.stack}`;
            }

            resultsDiv.textContent = output;
        }
    </script>
</body>
</html>