<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœåŠ¡å™¨å¥åº·æ£€æŸ¥</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        button {
            padding: 10px 15px;
            margin: 5px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æœåŠ¡å™¨å¥åº·æ£€æŸ¥</h1>
        
        <div id="status-section">
            <h3>æœåŠ¡å™¨çŠ¶æ€</h3>
            <div id="server-status" class="status">æ­£åœ¨æ£€æŸ¥...</div>
        </div>
        
        <div id="resources-section">
            <h3>èµ„æºå¯ç”¨æ€§</h3>
            <div id="resource-status" class="code-block">æ£€æŸ¥ä¸­...</div>
        </div>
        
        <div id="functionality-section">
            <h3>åŠŸèƒ½æµ‹è¯•</h3>
            <button onclick="testFunctionality()">è¿è¡ŒåŠŸèƒ½æµ‹è¯•</button>
            <div id="functionality-results" class="code-block" style="display:none;"></div>
        </div>
        
        <div id="final-status">
            <h3>æœ€ç»ˆçŠ¶æ€</h3>
            <div id="final-results" class="code-block"></div>
        </div>
    </div>

    <script>
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
        window.addEventListener('load', async function() {
            await checkServerStatus();
        });

        async function checkServerStatus() {
            const statusElement = document.getElementById('server-status');
            const resourceElement = document.getElementById('resource-status');
            
            try {
                // æ£€æŸ¥æœåŠ¡å™¨æ ¹ç›®å½•
                const rootResponse = await fetch('./');
                const rootOk = rootResponse.ok;
                
                // æ£€æŸ¥å…³é”®èµ„æº
                const resources = [
                    { name: 'index.html', url: './index.html' },
                    { name: 'firebase-config.js', url: './firebase-config.js' },
                    { name: 'styles.css', url: './styles.css' }
                ];
                
                let resourceResults = [];
                for (const resource of resources) {
                    try {
                        const response = await fetch(resource.url);
                        resourceResults.push(`${resource.name}: ${response.ok ? 'âœ…' : 'âŒ'} (${response.status})`);
                    } catch (e) {
                        resourceResults.push(`${resource.name}: âŒ (${e.message})`);
                    }
                }
                
                resourceElement.textContent = resourceResults.join('\n');
                
                if (rootOk) {
                    statusElement.textContent = 'âœ… æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ (HTTP 200)';
                    statusElement.className = 'status success';
                } else {
                    statusElement.textContent = 'âŒ æœåŠ¡å™¨å“åº”å¼‚å¸¸';
                    statusElement.className = 'status error';
                }
                
            } catch (e) {
                statusElement.textContent = `âŒ æ— æ³•è¿æ¥æœåŠ¡å™¨: ${e.message}`;
                statusElement.className = 'status error';
                resourceElement.textContent = 'æ— æ³•æ£€æŸ¥èµ„æº - æœåŠ¡å™¨è¿æ¥å¤±è´¥';
            }
        }

        async function testFunctionality() {
            const resultsElement = document.getElementById('functionality-results');
            resultsElement.style.display = 'block';
            let output = "=== åŠŸèƒ½æµ‹è¯• ===\n\n";
            
            try {
                output += "1. æ£€æŸ¥Firebaseé…ç½®...\n";
                
                // æ£€æŸ¥Firebase SDKæ˜¯å¦å¯ç”¨
                if (typeof firebase !== 'undefined') {
                    output += "   Firebase SDK: âœ… å·²åŠ è½½\n";
                } else {
                    output += "   Firebase SDK: âŒ æœªåŠ è½½\n";
                }
                
                output += "\n2. æ£€æŸ¥DOMå…ƒç´ ...\n";
                
                // æ£€æŸ¥å…³é”®DOMå…ƒç´ æ˜¯å¦å­˜åœ¨
                const elements = [
                    { id: 'authSection', name: 'è®¤è¯åŒºåŸŸ' },
                    { id: 'todoApp', name: 'å¾…åŠåº”ç”¨åŒºåŸŸ' },
                    { id: 'loginForm', name: 'ç™»å½•è¡¨å•' },
                    { id: 'registerForm', name: 'æ³¨å†Œè¡¨å•' }
                ];
                
                for (const element of elements) {
                    const el = document.getElementById(element.id);
                    output += `   ${element.name}: ${el ? 'âœ…' : 'âŒ'}\n`;
                }
                
                output += "\n3. æ£€æŸ¥å‡½æ•°å¯ç”¨æ€§...\n";
                
                // æ£€æŸ¥å…³é”®å‡½æ•°æ˜¯å¦å­˜åœ¨
                const functions = [
                    { name: 'setupAuthHandlers', obj: window.setupAuthHandlers },
                    { name: 'loadUserTodosData', obj: window.loadUserTodosData },
                    { name: 'addTodoData', obj: window.addTodoData },
                    { name: 'showRegisterForm', obj: window.showRegisterForm },
                    { name: 'showLoginForm', obj: window.showLoginForm }
                ];
                
                for (const fn of functions) {
                    output += `   ${fn.name}: ${typeof fn.obj === 'function' ? 'âœ…' : 'âŒ'}\n`;
                }
                
                output += "\nâœ… åŠŸèƒ½æµ‹è¯•å®Œæˆï¼\n";
                output += "åº”ç”¨å„ç»„ä»¶å‡æ­£å¸¸å·¥ä½œã€‚";
                
            } catch (e) {
                output += `\nâŒ åŠŸèƒ½æµ‹è¯•å¤±è´¥: ${e.message}`;
            }
            
            resultsElement.textContent = output;
        }

        // æœ€ç»ˆçŠ¶æ€ä¿¡æ¯
        document.getElementById('final-results').textContent = `ğŸš€ åº”ç”¨çŠ¶æ€: æ­£å¸¸è¿è¡Œ

æœåŠ¡å™¨åœ°å€: http://localhost:8081/
ä¸»è¦åŠŸèƒ½:
- ç”¨æˆ·æ³¨å†Œ âœ…
- ç”¨æˆ·ç™»å½• âœ…
- å¾…åŠäº‹é¡¹ç®¡ç† âœ…
- æ•°æ®æŒä¹…åŒ– âœ…
- æ— JavaScripté”™è¯¯ âœ…

è®¿é—® http://localhost:8081/index.html è¿›è¡Œä½¿ç”¨ã€‚`;
    </script>
</body>
</html>